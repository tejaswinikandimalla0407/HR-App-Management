graph TB
    %% =============================================================================
    %% HR MANAGEMENT SYSTEM - IMPLEMENTED FUNCTIONS MICROSERVICES ARCHITECTURE
    %% Based on your current server.js implementation
    %% =============================================================================
    
    %% Frontend Applications (Your Current HTML Pages)
    subgraph "🌐 Frontend Applications"
        direction TB
        
        subgraph "Employee Portal Pages"
            LOGIN[login.html<br/>📝 Employee Login]
            SIGNUP[signup.html<br/>👤 Employee Registration]
            DASH[dashboard.html<br/>🏠 Employee Dashboard]
            LEAVE_APPLY[apply_leave.html<br/>🏖️ Apply for Leave]
            LEAVE_BAL[leave_balance.html<br/>💰 View Leave Balance]
            ATTEND[attendance.html<br/>⏰ Check-in/Check-out]
            GRIEV[grievance.html<br/>📢 Submit Grievance]
            HIRE_FEED[hiring_process.html<br/>💼 Hiring Feedback]
        end
        
        subgraph "Admin Portal Pages"
            ADMIN_LOGIN[admin-login.html<br/>👨‍💼 Admin Login]
            ADMIN_DASH[admin-dashboard.html<br/>📊 Admin Dashboard]
            ADMIN_EMP[admin-employees.html<br/>👥 Employee Management]
            ADMIN_LEAVE[admin-leaves.html<br/>✅ Leave Approvals]
            ADMIN_ATT[admin-attendance.html<br/>📈 Attendance Reports]
            ADMIN_GRIEV[admin-grievances.html<br/>💬 Grievance Management]
        end
    end

    %% API Gateway (Your Current Express Server)
    subgraph "🚪 API Gateway Layer"
        GATEWAY[Express.js Server<br/>Port: 3000<br/>━━━━━━━━━━━━━━━━<br/>✅ Route Management<br/>📁 Static File Serving<br/>🔗 MongoDB Connection<br/>📊 Request Processing<br/>🌐 CORS Handling]
    end

    %% Microservices (Based on Your Implemented APIs)
    subgraph "🔧 Microservices Layer"
        direction TB
        
        subgraph "Authentication & User Management"
            AUTH_SERVICE[🔐 Authentication Service<br/>Port: 3001<br/>━━━━━━━━━━━━━━━━━━━━━━<br/>Implemented APIs:<br/>• POST /api/login<br/>• POST /api/signup<br/>• POST /api/admin/login<br/>━━━━━━━━━━━━━━━━━━━━━━<br/>Features:<br/>🔑 Employee Login/Signup<br/>👨‍💼 Admin Authentication<br/>📱 Basic Auth (no JWT)<br/>🔒 Password Validation<br/>👥 User Registration]
        end
        
        subgraph "Employee Management"
            EMP_SERVICE[👥 Employee Service<br/>Port: 3002<br/>━━━━━━━━━━━━━━━━━━━━━━<br/>Implemented APIs:<br/>• GET /api/admin/employees<br/>• PUT /api/admin/employees/:id<br/>• DELETE /api/admin/employees/:id<br/>━━━━━━━━━━━━━━━━━━━━━━<br/>Features:<br/>👤 Employee CRUD Operations<br/>📝 Profile Management<br/>🔍 Employee Listing<br/>✏️ Employee Updates<br/>❌ Employee Deletion<br/>🛡️ Password Protection]
        end
        
        subgraph "Leave Management"
            LEAVE_SERVICE[🏖️ Leave Service<br/>Port: 3003<br/>━━━━━━━━━━━━━━━━━━━━━━<br/>Implemented APIs:<br/>• POST /api/leave/apply<br/>• GET /api/leave/balance/:empId<br/>• GET /api/leave/history/:empId<br/>• GET /api/admin/leaves<br/>• PUT /api/admin/leaves/:id<br/>━━━━━━━━━━━━━━━━━━━━━━<br/>Features:<br/>📋 Leave Application<br/>💰 Leave Balance Calculation<br/>📈 Leave History Tracking<br/>✅ Admin Leave Approvals<br/>📊 Leave Request Analytics<br/>🔄 Status Updates]
        end
        
        subgraph "Attendance Management"
            ATT_SERVICE[⏰ Attendance Service<br/>Port: 3004<br/>━━━━━━━━━━━━━━━━━━━━━━<br/>Implemented APIs:<br/>• POST /api/attendance/checkin<br/>• POST /api/attendance/checkout<br/>• POST /api/attendance/today<br/>• GET /api/admin/attendance<br/>━━━━━━━━━━━━━━━━━━━━━━<br/>Features:<br/>✅ Employee Check-in/out<br/>⏱️ Time Tracking<br/>📈 Attendance Reports<br/>📅 Today's Status Check<br/>👨‍💼 Admin Attendance View<br/>📊 Attendance Analytics]
        end
        
        subgraph "Grievance Management"
            GRIEV_SERVICE[📢 Grievance Service<br/>Port: 3005<br/>━━━━━━━━━━━━━━━━━━━━━━<br/>Implemented APIs:<br/>• POST /api/grievance<br/>• GET /api/admin/grievances<br/>• PUT /api/admin/grievances/:id<br/>━━━━━━━━━━━━━━━━━━━━━━<br/>Features:<br/>📝 Grievance Submission<br/>📋 Status Tracking<br/>💬 Admin Responses<br/>🔍 Grievance Listing<br/>⚠️ Issue Management<br/>🕒 Timestamp Tracking]
        end
        
        subgraph "Analytics & Reporting"
            ANALYTICS_SERVICE[📊 Analytics Service<br/>Port: 3006<br/>━━━━━━━━━━━━━━━━━━━━━━<br/>Implemented APIs:<br/>• GET /api/admin/analytics<br/>━━━━━━━━━━━━━━━━━━━━━━<br/>Features:<br/>📈 HR Dashboard Metrics<br/>📊 Employee Statistics<br/>📉 Monthly Leave Trends<br/>📄 Attendance Reports<br/>💼 Overall HR Analytics<br/>🔢 Data Aggregation]
        end
        
        subgraph "HR Chatbot"
            CHAT_SERVICE[🤖 Chatbot Service<br/>Port: 3007<br/>━━━━━━━━━━━━━━━━━━━━━━<br/>Implemented APIs:<br/>• POST /api/chatbot<br/>━━━━━━━━━━━━━━━━━━━━━━<br/>Features:<br/>🧠 HR Knowledge Base<br/>💬 Query Processing<br/>📚 Policy Information<br/>📝 Chat Logging<br/>🎯 Context Recognition<br/>🔍 Help System]
        end
        
        subgraph "Hiring Management"
            HIRING_SERVICE[🏢 Hiring Service<br/>Port: 3008<br/>━━━━━━━━━━━━━━━━━━━━━━<br/>Implemented APIs:<br/>• POST /api/hiring/feedback<br/>• GET /api/admin/hiring<br/>• POST /api/admin/jobs<br/>• GET /api/jobs<br/>━━━━━━━━━━━━━━━━━━━━━━<br/>Features:<br/>💼 Job Posting Management<br/>📝 Hiring Feedback Collection<br/>🎯 Recruitment Process<br/>📊 Hiring Analytics<br/>👥 Candidate Management<br/>💡 Feedback Processing]
        end
    end

    %% Database Layer (Your Current MongoDB Setup)
    subgraph "💾 Database Architecture"
        direction TB
        
        subgraph "Current Monolithic Database"
            CURRENT_DB[(🗄️ hr_system (MongoDB)<br/>━━━━━━━━━━━━━━━━━━━━━━━━━<br/>Current Collections:<br/>• employees (login, profiles)<br/>• hr_admins (admin users)<br/>• leave_requests (leave data)<br/>• attendance (check-in/out)<br/>• grievances (complaints)<br/>• hiring_feedback (feedback)<br/>• chat_logs (chatbot data)<br/>• job_postings (job ads)<br/>━━━━━━━━━━━━━━━━━━━━━━━━━<br/>Single database for all data)]
        end
        
        subgraph "Target Microservices Databases"
            AUTH_DB[(🔐 auth_db<br/>• employees<br/>• hr_admins<br/>• user_sessions)]
            
            EMP_DB[(👥 employee_db<br/>• employee_profiles<br/>• departments<br/>• employee_roles)]
            
            LEAVE_DB[(🏖️ leave_db<br/>• leave_requests<br/>• leave_balances<br/>• leave_policies)]
            
            ATT_DB[(⏰ attendance_db<br/>• attendance_logs<br/>• work_schedules<br/>• time_tracking)]
            
            GRIEV_DB[(📢 grievance_db<br/>• grievances<br/>• admin_responses<br/>• escalation_logs)]
            
            ANALYTICS_DB[(📊 analytics_db<br/>• hr_metrics<br/>• generated_reports<br/>• dashboard_data)]
            
            CHAT_DB[(🤖 chatbot_db<br/>• chat_logs<br/>• knowledge_base<br/>• conversation_history)]
            
            HIRE_DB[(🏢 hiring_db<br/>• job_postings<br/>• hiring_feedback<br/>• recruitment_data)]
        end
    end

    %% Your Implemented API Endpoints
    subgraph "🔌 Implemented API Endpoints"
        direction TB
        
        subgraph "Employee APIs (Implemented)"
            EMP_APIS[Employee Endpoints<br/>━━━━━━━━━━━━━━━━━━━━━━<br/>Authentication:<br/>• POST /api/signup<br/>• POST /api/login<br/>━━━━━━━━━━━━━━━━━━━━━━<br/>Leave Management:<br/>• POST /api/leave/apply<br/>• GET /api/leave/balance/:empId<br/>• GET /api/leave/history/:empId<br/>━━━━━━━━━━━━━━━━━━━━━━<br/>Attendance:<br/>• POST /api/attendance/checkin<br/>• POST /api/attendance/checkout<br/>• POST /api/attendance/today<br/>━━━━━━━━━━━━━━━━━━━━━━<br/>Other Services:<br/>• POST /api/grievance<br/>• POST /api/hiring/feedback<br/>• POST /api/chatbot<br/>• GET /api/jobs]
        end
        
        subgraph "Admin APIs (Implemented)"
            ADMIN_APIS[Admin Endpoints<br/>━━━━━━━━━━━━━━━━━━━━━━<br/>Authentication:<br/>• POST /api/admin/login<br/>━━━━━━━━━━━━━━━━━━━━━━<br/>Employee Management:<br/>• GET /api/admin/employees<br/>• PUT /api/admin/employees/:id<br/>• DELETE /api/admin/employees/:id<br/>━━━━━━━━━━━━━━━━━━━━━━<br/>Leave Management:<br/>• GET /api/admin/leaves<br/>• PUT /api/admin/leaves/:id<br/>━━━━━━━━━━━━━━━━━━━━━━<br/>Other Admin Functions:<br/>• GET /api/admin/attendance<br/>• GET /api/admin/grievances<br/>• PUT /api/admin/grievances/:id<br/>• GET /api/admin/analytics<br/>• GET /api/admin/hiring<br/>• POST /api/admin/jobs]
        end
    end

    %% HR Knowledge Base (Your Chatbot Data)
    subgraph "🧠 HR Knowledge Base (Implemented)"
        KB[HR Knowledge Base<br/>━━━━━━━━━━━━━━━━━━━━━━<br/>Implemented Policies:<br/>• Leave Policy (12 CL, 10 SL, 15 AL)<br/>• Attendance Policy (9 AM - 6 PM)<br/>• Holiday Information<br/>• Grievance Procedure<br/>• Salary Policy<br/>• Dress Code Policy<br/>• Remote Work Policy<br/>• Training Programs<br/>• Performance Review<br/>• Benefits Information<br/>━━━━━━━━━━━━━━━━━━━━━━<br/>Chatbot Responses:<br/>• Context Recognition<br/>• Help System<br/>• Policy Queries<br/>• Greeting Responses]
    end

    %% ===========================
    %% CONNECTION DEFINITIONS
    %% ===========================

    %% Frontend to Gateway connections
    LOGIN --> GATEWAY
    SIGNUP --> GATEWAY
    DASH --> GATEWAY
    LEAVE_APPLY --> GATEWAY
    LEAVE_BAL --> GATEWAY
    ATTEND --> GATEWAY
    GRIEV --> GATEWAY
    HIRE_FEED --> GATEWAY
    ADMIN_LOGIN --> GATEWAY
    ADMIN_DASH --> GATEWAY
    ADMIN_EMP --> GATEWAY
    ADMIN_LEAVE --> GATEWAY
    ADMIN_ATT --> GATEWAY
    ADMIN_GRIEV --> GATEWAY

    %% Gateway to Services (Target Architecture)
    GATEWAY --> AUTH_SERVICE
    GATEWAY --> EMP_SERVICE
    GATEWAY --> LEAVE_SERVICE
    GATEWAY --> ATT_SERVICE
    GATEWAY --> GRIEV_SERVICE
    GATEWAY --> ANALYTICS_SERVICE
    GATEWAY --> CHAT_SERVICE
    GATEWAY --> HIRING_SERVICE

    %% Current Database Connections (Monolithic)
    AUTH_SERVICE -.-> CURRENT_DB
    EMP_SERVICE -.-> CURRENT_DB
    LEAVE_SERVICE -.-> CURRENT_DB
    ATT_SERVICE -.-> CURRENT_DB
    GRIEV_SERVICE -.-> CURRENT_DB
    ANALYTICS_SERVICE -.-> CURRENT_DB
    CHAT_SERVICE -.-> CURRENT_DB
    HIRING_SERVICE -.-> CURRENT_DB

    %% Target Database Connections (Microservices)
    AUTH_SERVICE --> AUTH_DB
    EMP_SERVICE --> EMP_DB
    LEAVE_SERVICE --> LEAVE_DB
    ATT_SERVICE --> ATT_DB
    GRIEV_SERVICE --> GRIEV_DB
    ANALYTICS_SERVICE --> ANALYTICS_DB
    CHAT_SERVICE --> CHAT_DB
    HIRING_SERVICE --> HIRE_DB

    %% API to Service Mapping
    EMP_APIS -.-> AUTH_SERVICE
    EMP_APIS -.-> LEAVE_SERVICE
    EMP_APIS -.-> ATT_SERVICE
    EMP_APIS -.-> GRIEV_SERVICE
    EMP_APIS -.-> CHAT_SERVICE
    EMP_APIS -.-> HIRING_SERVICE

    ADMIN_APIS -.-> AUTH_SERVICE
    ADMIN_APIS -.-> EMP_SERVICE
    ADMIN_APIS -.-> LEAVE_SERVICE
    ADMIN_APIS -.-> ATT_SERVICE
    ADMIN_APIS -.-> GRIEV_SERVICE
    ADMIN_APIS -.-> ANALYTICS_SERVICE
    ADMIN_APIS -.-> HIRING_SERVICE

    %% Chatbot Knowledge Base
    CHAT_SERVICE --> KB

    %% Inter-service Dependencies (Your Current Logic)
    LEAVE_SERVICE -.-> EMP_SERVICE
    ATT_SERVICE -.-> EMP_SERVICE
    GRIEV_SERVICE -.-> EMP_SERVICE
    ANALYTICS_SERVICE -.-> AUTH_SERVICE
    ANALYTICS_SERVICE -.-> LEAVE_SERVICE
    ANALYTICS_SERVICE -.-> ATT_SERVICE

    %% ===========================
    %% STYLING DEFINITIONS
    %% ===========================

    classDef frontendStyle fill:#E3F2FD,stroke:#1976D2,stroke-width:2px,color:#0D47A1,font-size:11px
    classDef adminFrontendStyle fill:#F3E5F5,stroke:#7B1FA2,stroke-width:2px,color:#4A148C,font-size:11px
    classDef gatewayStyle fill:#FFF3E0,stroke:#F57C00,stroke-width:3px,color:#E65100,font-size:12px
    classDef authStyle fill:#FFEBEE,stroke:#D32F2F,stroke-width:2px,color:#B71C1C,font-size:11px
    classDef coreStyle fill:#E8F5E8,stroke:#388E3C,stroke-width:2px,color:#1B5E20,font-size:11px
    classDef businessStyle fill:#E1F5FE,stroke:#0288D1,stroke-width:2px,color:#01579B,font-size:11px
    classDef currentDbStyle fill:#FFCDD2,stroke:#F44336,stroke-width:3px,color:#C62828,font-size:11px
    classDef targetDbStyle fill:#FFF8E1,stroke:#FFA000,stroke-width:2px,color:#FF6F00,font-size:11px
    classDef apiStyle fill:#FCE4EC,stroke:#C2185B,stroke-width:2px,color:#880E4F,font-size:11px
    classDef kbStyle fill:#F1F8E9,stroke:#689F38,stroke-width:2px,color:#33691E,font-size:11px

    %% Apply Styles
    class LOGIN,SIGNUP,DASH,LEAVE_APPLY,LEAVE_BAL,ATTEND,GRIEV,HIRE_FEED frontendStyle
    class ADMIN_LOGIN,ADMIN_DASH,ADMIN_EMP,ADMIN_LEAVE,ADMIN_ATT,ADMIN_GRIEV adminFrontendStyle
    class GATEWAY gatewayStyle
    class AUTH_SERVICE authStyle
    class EMP_SERVICE,LEAVE_SERVICE,ATT_SERVICE coreStyle
    class GRIEV_SERVICE,ANALYTICS_SERVICE,CHAT_SERVICE,HIRING_SERVICE businessStyle
    class CURRENT_DB currentDbStyle
    class AUTH_DB,EMP_DB,LEAVE_DB,ATT_DB,GRIEV_DB,ANALYTICS_DB,CHAT_DB,HIRE_DB targetDbStyle
    class EMP_APIS,ADMIN_APIS apiStyle
    class KB kbStyle
